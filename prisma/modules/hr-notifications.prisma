// HR notification models with tenant scoping and compliance metadata

enum HRNotificationType {
  LEAVE_APPROVAL       @map("leave-approval")
  LEAVE_REJECTION      @map("leave-rejection")
  DOCUMENT_EXPIRY      @map("document-expiry")
  POLICY_UPDATE        @map("policy-update")
  PERFORMANCE_REVIEW   @map("performance-review")
  TIME_ENTRY           @map("time-entry")
  TRAINING_ASSIGNED    @map("training-assigned")
  TRAINING_DUE         @map("training-due")
  TRAINING_COMPLETED   @map("training-completed")
  TRAINING_OVERDUE     @map("training-overdue")
  SYSTEM_ANNOUNCEMENT  @map("system-announcement")
  COMPLIANCE_REMINDER  @map("compliance-reminder")
  OTHER                @map("other")
  @@schema("hr")
}

enum NotificationPriority {
  LOW    @map("low")
  MEDIUM @map("medium")
  HIGH   @map("high")
  URGENT @map("urgent")
  @@schema("hr")
}

model HRNotification {
  id               String                 @id @default(uuid()) @db.Uuid
  orgId            String                 @db.Uuid
  userId           String                 @db.Uuid
  title            String
  message          String
  type             HRNotificationType     @default(OTHER)
  priority         NotificationPriority   @default(MEDIUM)
  isRead           Boolean                @default(false)
  readAt           DateTime?
  actionUrl        String?
  actionLabel      String?
  scheduledFor     DateTime?
  expiresAt        DateTime?
  correlationId    String?
  createdByUserId  String?                @db.Uuid
  dataClassification DataClassificationLevel @default(OFFICIAL)
  residencyTag       DataResidencyZone       @default(UK_ONLY)
  metadata         Json?                  @db.JsonB
  createdAt        DateTime               @default(now())
  updatedAt        DateTime               @updatedAt

  org        Organization @relation(fields: [orgId], references: [id], onDelete: Cascade)
  membership Membership   @relation(fields: [orgId, userId], references: [orgId, userId], onDelete: Cascade)

  @@index([orgId, userId, isRead])
  @@index([orgId, userId, type])
  @@index([orgId, scheduledFor])
  @@index([orgId, priority, createdAt])
  @@map("notifications")
  @@schema("hr")
}
